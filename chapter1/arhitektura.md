#Архитектура
![Диаграмма архитектурных слоев](/assets/arch_structure.jpg)

##Слои

###[Слой представления](http://devdocs.magento.com/guides/v2.1/architecture/archi_perspectives/present_layer.html)
Содержит оба уровня элементов представления: разметку (layout), блоки (block),
шаблоны (template), также контроллеры (controller)
Представления разделяются на две освновных категории: блоки и контейнеры/
- блоки могут генерировать динамическое содержимое и могут содержать именованные дочерние элементы представления, которые похожи на передаваемые агрументы
- контейнеры объединяют упорядоченные группы дочерних элементов представления
Слой представления обычно взаимодействует с сервисным слоем, особенно на витрине магазина. Тем не менее может взаимодействовать с слоем бизнес логики.

###[Сервисный слой](http://devdocs.magento.com/guides/v2.1/architecture/archi_perspectives/service_layer.html)
Посредник между представлением и бизнес логикой.
Содержит сервисные контракты
Обеспечивает легкое взаимодействие с REST/SOAP API
Предоставляет стибильный интерфейс для модулей
Сервисный контракт определяется занным интерфейсом моудля в каталоге /Api
Обычно взаимодействует с интерфейсами репозиториев, метаданных, управляющими (management) интерфейесами

###[Слой домена](http://devdocs.magento.com/guides/v2.1/architecture/archi_perspectives/domain_layer.html)
Содержит бизнес-логику модулей Magento. Как правило не содержит информацию о расположении и хранении данных.
Основные функции:
- определение исходных объектов данных или моделей Magento, содержащих бизнес-логику
- может включать реализацию (не интерфейс) сервисных контрактов
Каждая модель слоя домена содержит ссылку на ресурсную модель, которая используется для доступа к данным в БД.

###[Слой состояния](http://devdocs.magento.com/guides/v2.1/architecture/archi_perspectives/persist_layer.html)
Magento использует шаблон Active Record для сохранения состояние модели. 
Модели объектов содержат ресурсные модели, связывающие объект и запись или записи в БД.
Ресурсная модель обечпечивает функции:
- CRUD, может содержать SQL код
- исполнение дополнительной бизнес логики (например, валидацию, обработку данных до и после сохранения)   
Для получения списков данных нужно реализовать особый тип ресурсной модели - коллекцию.
Объекты с большим количеством атрибутов (или имеющие зависимые объекты с большим количество атрибутов) представляют собой EAV (Сущность-атрибут-значение) модели
Такими являются Customer, Catalog, Order  

##Компоненты

###[Модуль](http://devdocs.magento.com/guides/v2.1/architecture/archi_perspectives/components/modules/mod_intro.html)
Модуль - логическая группа, или директория, содержащая блоки, контроллеры, помощники, модели относящиеся к конкретной бизнес функциии.  
**Блок** обспечивает использвание данных и представлении, связывает модели и шаблоны. Файлы в этом каталоге загружают данные из БД и передают в шаблоны.  
**Контроллер** - представляют все действия бизнес-лоики для входящих запросов. Часть парадигмы MVC  
**/etc** - конфигурационные файлы описывающие поведение модулей. Файлы в директории etc модуля доступны всему модулю.   
Тогда как файлы в etc поддиректориях (adminhtml, frontend, webapi_rest, webapi_soap, crontab) видны только в своих функциональных областях  
**Помощники** - служебные методы ,используемы во всем приложении. Они могут быть вызваны как в представлении, так и в контроллере. 
Каждый модуль имеет класс помощник по-умолчанию Modulename/Helper/Data.php    
**Модель** - типичная модель парадигмы MVC.

####Пространства модуля
Пространство (area) логический компонент, организующий код для оптимальной обработки запроса.
Magento использует пространства для оптимизации вызовов веб-сервисов посредством загрузки только необходимых классов для конкретного простанства.
Основные пространства:
- adminhtml
- frontend
- base 

   
